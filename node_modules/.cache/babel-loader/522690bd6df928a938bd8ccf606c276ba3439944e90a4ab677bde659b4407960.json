{"ast":null,"code":"var _jsxFileName = \"/Users/zyq/Desktop/\\u5927\\u4E8C\\u4E0B/\\u6691\\u671F\\u5B9E\\u4E60/moonshot project/src/components/Moon.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useMemo } from 'react';\nimport styled, { keyframes } from 'styled-components';\nimport { moonImage, starIcon, meteorIcon, flower1Icon, flower2Icon, flower3Icon, othersIcon } from '../assets';\nimport { ReplyBox } from './ReplyBox';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst rotate = keyframes`\n  from { transform: rotate(0deg); }\n  to   { transform: rotate(360deg); }\n`;\nconst float = keyframes`\n  0%   { transform: translateY(0) translateX(0); }\n  50%  { transform: translateY(-8px) translateX(5px); }\n  100% { transform: translateY(0) translateX(0); }\n`;\nconst MoonContainer = styled.div`\n  position: absolute;\n  top: 50%; left: 50%;\n  transform: translate(-50%, -50%);\n  width: 360px; height: 360px;\n  pointer-events: none;\n`;\n_c = MoonContainer;\nconst MoonSphere = styled.div`\n  width: 100%; height: 100%;\n  border-radius: 50%;\n  background: url(${moonImage}) no-repeat center center;\n  background-size: cover;\n  animation: ${rotate} 60s linear infinite;\n  box-shadow: inset -25px -25px 40px rgba(0,0,0,0.3);\n`;\n_c2 = MoonSphere;\nconst FlowerOverlay = styled.div`\n  position: absolute;\n  top: 0; left: 0;\n  width: 100%; height: 100%;\n  pointer-events: auto;\n`;\n_c3 = FlowerOverlay;\nconst FlowerDot = styled.div`\n  position: absolute;\n  left: ${p => p.$x}px;\n  top: ${p => p.$y}px;\n  width: 32px;\n  height: 32px;\n  background-size: contain;\n  background-repeat: no-repeat;\n  background-position: center;\n  background-image: ${p => p.flowerType === 'flower1' ? `url(${flower1Icon})` : p.flowerType === 'flower2' ? `url(${flower2Icon})` : `url(${flower3Icon})`};\n`;\n_c4 = FlowerDot;\nconst CelestialBodyContainer = styled.div`\n  position: absolute;\n  left: ${props => props.x}px;\n  top: ${props => props.y}px;\n  width: 48px;\n  height: 48px;\n  background-size: contain;\n  background-repeat: no-repeat;\n  cursor: pointer;\n  transition: transform 0.3s ease-in-out;\n  animation: ${props => props.isExternal && props.isReplied ? 'moveAway 5s ease-in-out forwards' : 'none'};\n\n  ${props => {\n  if (props.isExternal) {\n    return `background-image: url(${othersIcon});`;\n  }\n  switch (props.type) {\n    case 'positive':\n      return `background-image: url(${starIcon});`;\n    case 'negative':\n      return `background-image: url(${meteorIcon});`;\n    case 'received':\n      return `background-image: url(${starIcon});`;\n    default:\n      return '';\n  }\n}}\n\n  &:hover {\n    transform: scale(1.2);\n    z-index: 10;\n  }\n`;\n_c5 = CelestialBodyContainer;\nconst Tooltip = styled.div`\n  position: absolute;\n  left: 50%;\n  top: -40px;\n  transform: translateX(-50%);\n  background: rgba(0, 0, 0, 0.8);\n  color: white;\n  padding: 8px 12px;\n  border-radius: 6px;\n  font-size: 14px;\n  white-space: pre-wrap;\n  pointer-events: none;\n  opacity: 0;\n  transition: all 0.2s ease;\n  z-index: 100;\n  min-width: 120px;\n  max-width: 200px;\n  text-align: center;\n  display: none;\n\n  ${CelestialBodyContainer}:hover & {\n    opacity: 1;\n    display: block;\n  }\n\n  &::after {\n    content: '';\n    position: absolute;\n    left: 50%;\n    bottom: -5px;\n    transform: translateX(-50%) rotate(45deg);\n    width: 10px;\n    height: 10px;\n    background: rgba(0, 0, 0, 0.8);\n  }\n`;\n_c6 = Tooltip;\nconst PositionWrapper = styled.div`\n  position: fixed;\n  left: 0;\n  top: 0;\n  width: 100vw;\n  height: 100vh;\n  pointer-events: none;\n`;\n_c7 = PositionWrapper;\nconst ResponseMessage = styled.div`\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  background: rgba(0, 0, 0, 0.8);\n  color: white;\n  padding: 15px 25px;\n  border-radius: 20px;\n  z-index: 1000;\n  animation: fadeInOut 5s ease-in-out forwards;\n\n  @keyframes fadeInOut {\n    0% {\n      opacity: 0;\n      transform: translate(-50%, -30%);\n    }\n    20% {\n      opacity: 1;\n      transform: translate(-50%, -50%);\n    }\n    80% {\n      opacity: 1;\n      transform: translate(-50%, -50%);\n    }\n    100% {\n      opacity: 0;\n      transform: translate(-50%, -70%);\n    }\n  }\n`;\n_c8 = ResponseMessage;\nexport const Moon = ({\n  celestialBodies,\n  setCelestialBodies,\n  flowers = [],\n  isRadioOn = false\n}) => {\n  _s();\n  const [positions, setPositions] = useState({});\n  const [selectedCelestialBody, setSelectedCelestialBody] = useState(null);\n  const [repliedBodies, setRepliedBodies] = useState(new Set());\n  const [showResponseMessage, setShowResponseMessage] = useState(false);\n\n  // ✅ 修正了原来的 moonCenter 计算逻辑\n  const moonCenter = useMemo(() => {\n    const topOffset = 120;\n    const bottomOffset = 180;\n    return {\n      x: window.innerWidth / 2,\n      y: (window.innerHeight - topOffset - bottomOffset) / 2 + topOffset\n    };\n  }, []);\n  useEffect(() => {\n    // 检测新添加的天体\n    celestialBodies.forEach(body => {\n      if (!positions[body.id]) {\n        setRepliedBodies(prev => new Set([...prev, body.id]));\n        // 5秒后移除新天体标记\n        setTimeout(() => {\n          setRepliedBodies(prev => {\n            const next = new Set(prev);\n            next.delete(body.id);\n            return next;\n          });\n        }, 5000);\n      }\n    });\n    const w = window.innerWidth;\n    const h = window.innerHeight;\n    const moonR = 150;\n    const celestialSize = 48;\n    const moonX = moonCenter.x;\n    const moonY = moonCenter.y;\n    const topMargin = 120;\n    const bottomMargin = 180;\n    const sideMargin = 100;\n    const minX = sideMargin;\n    const maxX = w - sideMargin - celestialSize;\n    const minY = topMargin;\n    const maxY = h - bottomMargin - celestialSize;\n    const safeDistance = moonR + 80;\n    const newPos = {};\n    celestialBodies.forEach(body => {\n      if (positions[body.id]) {\n        newPos[body.id] = positions[body.id];\n      } else {\n        let x,\n          y,\n          cnt = 0;\n        let angle;\n        do {\n          angle = Math.random() * Math.PI * 2;\n          const minDist = safeDistance;\n          const maxDist = Math.min(Math.min(moonX - minX, maxX - moonX) * 1.2, Math.min(moonY - minY, maxY - moonY) * 2.7);\n          const distance = minDist + Math.random() * (maxDist - minDist);\n          x = moonX + Math.cos(angle) * distance;\n          y = moonY + Math.sin(angle) * distance;\n          x = Math.max(minX, Math.min(maxX, x));\n          y = Math.max(minY, Math.min(maxY, y));\n          cnt++;\n        } while (cnt < 100 && Object.values(newPos).some(pos => Math.hypot(x - pos.x, y - pos.y) < celestialSize * 1.5));\n        newPos[body.id] = {\n          x,\n          y\n        };\n      }\n    });\n    setPositions(newPos);\n  }, [celestialBodies, moonCenter]);\n  const handleCelestialBodyClick = body => {\n    if (body.isExternal && isRadioOn) {\n      setSelectedCelestialBody(body);\n    }\n  };\n  const handleReplySubmit = replyText => {\n    if (selectedCelestialBody && replyText.trim()) {\n      const updatedReplies = new Set([...Array.from(selectedCelestialBody.replies), replyText]);\n      const updatedCelestialBodies = celestialBodies.map(body => {\n        if (body.id === selectedCelestialBody.id) {\n          return {\n            ...body,\n            replies: updatedReplies\n          };\n        }\n        return body;\n      });\n      setCelestialBodies(updatedCelestialBodies);\n      setRepliedBodies(prev => new Set([...prev, selectedCelestialBody.id]));\n      // 只有特殊星体回复后才显示文案\n      setShowResponseMessage(true);\n      setTimeout(() => {\n        setShowResponseMessage(false);\n      }, 5000);\n    }\n    setSelectedCelestialBody(null);\n  };\n  const handleReplyClose = () => {\n    setSelectedCelestialBody(null);\n  };\n  const visibleBodies = celestialBodies.filter(body => !body.isExternal || body.isExternal && isRadioOn);\n  return /*#__PURE__*/_jsxDEV(PositionWrapper, {\n    children: [/*#__PURE__*/_jsxDEV(MoonContainer, {\n      children: [/*#__PURE__*/_jsxDEV(MoonSphere, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 324,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(FlowerOverlay, {\n        children: flowers.map((flower, index) => /*#__PURE__*/_jsxDEV(FlowerDot, {\n          $x: flower.position.x,\n          $y: flower.position.y,\n          flowerType: flower.style === 'flower1' ? 'flower1' : flower.style === 'flower2' ? 'flower2' : 'flower3'\n        }, flower.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 327,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 7\n    }, this), visibleBodies.map(body => {\n      const pos = positions[body.id];\n      if (!pos) return null;\n      const isReplied = repliedBodies.has(body.id);\n      return /*#__PURE__*/_jsxDEV(CelestialBodyContainer, {\n        type: body.type,\n        x: pos.x,\n        y: pos.y,\n        isExternal: body.isExternal,\n        isReplied: isReplied && body.isExternal,\n        onClick: () => handleCelestialBodyClick(body),\n        children: /*#__PURE__*/_jsxDEV(Tooltip, {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              margin: 0\n            },\n            children: body.content\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 352,\n            columnNumber: 15\n          }, this), body.isExternal && /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              margin: '5px 0 0 0'\n            },\n            children: [\"\\u6765\\u81EA\\uFF1A\", body.sender]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 353,\n            columnNumber: 35\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 351,\n          columnNumber: 13\n        }, this)\n      }, body.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 11\n      }, this);\n    }), selectedCelestialBody && /*#__PURE__*/_jsxDEV(ReplyBox, {\n      content: selectedCelestialBody.content,\n      onSubmit: handleReplySubmit,\n      onClose: handleReplyClose,\n      replies: Array.from(selectedCelestialBody.replies)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 360,\n      columnNumber: 9\n    }, this), showResponseMessage && (selectedCelestialBody === null || selectedCelestialBody === void 0 ? void 0 : selectedCelestialBody.isExternal) && /*#__PURE__*/_jsxDEV(ResponseMessage, {\n      children: \"\\u4F60\\u7684\\u56DE\\u5E94\\uFF0C\\u6B63\\u968F\\u7740\\u5FAE\\u5149\\uFF0C\\u7A7F\\u8D8A\\u5B87\\u5B99\\u98DE\\u5411\\u4ED6\\u4EBA\\uD83D\\uDCAB\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 369,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 322,\n    columnNumber: 5\n  }, this);\n};\n_s(Moon, \"Gz8sR8Ma3fmJPCYnODt4lbVW+UU=\");\n_c9 = Moon;\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9;\n$RefreshReg$(_c, \"MoonContainer\");\n$RefreshReg$(_c2, \"MoonSphere\");\n$RefreshReg$(_c3, \"FlowerOverlay\");\n$RefreshReg$(_c4, \"FlowerDot\");\n$RefreshReg$(_c5, \"CelestialBodyContainer\");\n$RefreshReg$(_c6, \"Tooltip\");\n$RefreshReg$(_c7, \"PositionWrapper\");\n$RefreshReg$(_c8, \"ResponseMessage\");\n$RefreshReg$(_c9, \"Moon\");","map":{"version":3,"names":["React","useState","useEffect","useMemo","styled","keyframes","moonImage","starIcon","meteorIcon","flower1Icon","flower2Icon","flower3Icon","othersIcon","ReplyBox","jsxDEV","_jsxDEV","rotate","float","MoonContainer","div","_c","MoonSphere","_c2","FlowerOverlay","_c3","FlowerDot","p","$x","$y","flowerType","_c4","CelestialBodyContainer","props","x","y","isExternal","isReplied","type","_c5","Tooltip","_c6","PositionWrapper","_c7","ResponseMessage","_c8","Moon","celestialBodies","setCelestialBodies","flowers","isRadioOn","_s","positions","setPositions","selectedCelestialBody","setSelectedCelestialBody","repliedBodies","setRepliedBodies","Set","showResponseMessage","setShowResponseMessage","moonCenter","topOffset","bottomOffset","window","innerWidth","innerHeight","forEach","body","id","prev","setTimeout","next","delete","w","h","moonR","celestialSize","moonX","moonY","topMargin","bottomMargin","sideMargin","minX","maxX","minY","maxY","safeDistance","newPos","cnt","angle","Math","random","PI","minDist","maxDist","min","distance","cos","sin","max","Object","values","some","pos","hypot","handleCelestialBodyClick","handleReplySubmit","replyText","trim","updatedReplies","Array","from","replies","updatedCelestialBodies","map","handleReplyClose","visibleBodies","filter","children","fileName","_jsxFileName","lineNumber","columnNumber","flower","index","position","style","has","onClick","margin","content","sender","onSubmit","onClose","_c9","$RefreshReg$"],"sources":["/Users/zyq/Desktop/大二下/暑期实习/moonshot project/src/components/Moon.tsx"],"sourcesContent":["import React, { useState, useEffect, useMemo } from 'react';\nimport styled, { keyframes } from 'styled-components';\nimport { CelestialBody, Flower, EmotionType } from '../types';\nimport {\n  moonImage,\n  starIcon,\n  meteorIcon,\n  flower1Icon,\n  flower2Icon,\n  flower3Icon,\n  othersIcon\n} from '../assets';\nimport { ReplyBox } from './ReplyBox';\n\nconst rotate = keyframes`\n  from { transform: rotate(0deg); }\n  to   { transform: rotate(360deg); }\n`;\n\nconst float = keyframes`\n  0%   { transform: translateY(0) translateX(0); }\n  50%  { transform: translateY(-8px) translateX(5px); }\n  100% { transform: translateY(0) translateX(0); }\n`;\n\nconst MoonContainer = styled.div`\n  position: absolute;\n  top: 50%; left: 50%;\n  transform: translate(-50%, -50%);\n  width: 360px; height: 360px;\n  pointer-events: none;\n`;\n\nconst MoonSphere = styled.div`\n  width: 100%; height: 100%;\n  border-radius: 50%;\n  background: url(${moonImage}) no-repeat center center;\n  background-size: cover;\n  animation: ${rotate} 60s linear infinite;\n  box-shadow: inset -25px -25px 40px rgba(0,0,0,0.3);\n`;\n\nconst FlowerOverlay = styled.div`\n  position: absolute;\n  top: 0; left: 0;\n  width: 100%; height: 100%;\n  pointer-events: auto;\n`;\n\ninterface FlowerDotProps {\n  $x: number;\n  $y: number;\n  flowerType: 'flower1' | 'flower2' | 'flower3';\n}\nconst FlowerDot = styled.div<FlowerDotProps>`\n  position: absolute;\n  left: ${p => p.$x}px;\n  top: ${p => p.$y}px;\n  width: 32px;\n  height: 32px;\n  background-size: contain;\n  background-repeat: no-repeat;\n  background-position: center;\n  background-image: ${p =>\n    p.flowerType === 'flower1'\n      ? `url(${flower1Icon})`\n      : p.flowerType === 'flower2'\n      ? `url(${flower2Icon})`\n      : `url(${flower3Icon})`};\n`;\n\nconst CelestialBodyContainer = styled.div<{\n  type: EmotionType;\n  x: number;\n  y: number;\n  isExternal?: boolean;\n  isReplied?: boolean;\n}>`\n  position: absolute;\n  left: ${props => props.x}px;\n  top: ${props => props.y}px;\n  width: 48px;\n  height: 48px;\n  background-size: contain;\n  background-repeat: no-repeat;\n  cursor: pointer;\n  transition: transform 0.3s ease-in-out;\n  animation: ${props => props.isExternal && props.isReplied ? 'moveAway 5s ease-in-out forwards' : 'none'};\n\n  ${props => {\n    if (props.isExternal) {\n      return `background-image: url(${othersIcon});`;\n    }\n    switch (props.type) {\n      case 'positive':\n        return `background-image: url(${starIcon});`;\n      case 'negative':\n        return `background-image: url(${meteorIcon});`;\n      case 'received':\n        return `background-image: url(${starIcon});`;\n      default:\n        return '';\n    }\n  }}\n\n  &:hover {\n    transform: scale(1.2);\n    z-index: 10;\n  }\n`;\n\nconst Tooltip = styled.div`\n  position: absolute;\n  left: 50%;\n  top: -40px;\n  transform: translateX(-50%);\n  background: rgba(0, 0, 0, 0.8);\n  color: white;\n  padding: 8px 12px;\n  border-radius: 6px;\n  font-size: 14px;\n  white-space: pre-wrap;\n  pointer-events: none;\n  opacity: 0;\n  transition: all 0.2s ease;\n  z-index: 100;\n  min-width: 120px;\n  max-width: 200px;\n  text-align: center;\n  display: none;\n\n  ${CelestialBodyContainer}:hover & {\n    opacity: 1;\n    display: block;\n  }\n\n  &::after {\n    content: '';\n    position: absolute;\n    left: 50%;\n    bottom: -5px;\n    transform: translateX(-50%) rotate(45deg);\n    width: 10px;\n    height: 10px;\n    background: rgba(0, 0, 0, 0.8);\n  }\n`;\n\nconst PositionWrapper = styled.div`\n  position: fixed;\n  left: 0;\n  top: 0;\n  width: 100vw;\n  height: 100vh;\n  pointer-events: none;\n`;\n\nconst ResponseMessage = styled.div`\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  background: rgba(0, 0, 0, 0.8);\n  color: white;\n  padding: 15px 25px;\n  border-radius: 20px;\n  z-index: 1000;\n  animation: fadeInOut 5s ease-in-out forwards;\n\n  @keyframes fadeInOut {\n    0% {\n      opacity: 0;\n      transform: translate(-50%, -30%);\n    }\n    20% {\n      opacity: 1;\n      transform: translate(-50%, -50%);\n    }\n    80% {\n      opacity: 1;\n      transform: translate(-50%, -50%);\n    }\n    100% {\n      opacity: 0;\n      transform: translate(-50%, -70%);\n    }\n  }\n`;\n\ninterface MoonProps {\n  celestialBodies: CelestialBody[];\n  setCelestialBodies: React.Dispatch<React.SetStateAction<CelestialBody[]>>;\n  flowers?: Flower[];\n  isRadioOn?: boolean;\n}\n\nexport const Moon: React.FC<MoonProps> = ({\n  celestialBodies,\n  setCelestialBodies,\n  flowers = [],\n  isRadioOn = false\n}) => {\n  const [positions, setPositions] = useState<Record<string, { x: number; y: number }>>({});\n  const [selectedCelestialBody, setSelectedCelestialBody] = useState<CelestialBody | null>(null);\n  const [repliedBodies, setRepliedBodies] = useState<Set<string>>(new Set());\n  const [showResponseMessage, setShowResponseMessage] = useState(false);\n\n  // ✅ 修正了原来的 moonCenter 计算逻辑\n  const moonCenter = useMemo(() => {\n    const topOffset = 120;\n    const bottomOffset = 180;\n    return {\n      x: window.innerWidth / 2,\n      y: (window.innerHeight - topOffset - bottomOffset) / 2 + topOffset\n    };\n  }, []);\n\n  useEffect(() => {\n    // 检测新添加的天体\n    celestialBodies.forEach(body => {\n      if (!positions[body.id]) {\n        setRepliedBodies(prev => new Set([...prev, body.id]));\n        // 5秒后移除新天体标记\n        setTimeout(() => {\n          setRepliedBodies(prev => {\n            const next = new Set(prev);\n            next.delete(body.id);\n            return next;\n          });\n        }, 5000);\n      }\n    });\n\n    const w = window.innerWidth;\n    const h = window.innerHeight;\n    const moonR = 150;\n    const celestialSize = 48;\n\n    const moonX = moonCenter.x;\n    const moonY = moonCenter.y;\n\n    const topMargin = 120;\n    const bottomMargin = 180;\n    const sideMargin = 100;\n\n    const minX = sideMargin;\n    const maxX = w - sideMargin - celestialSize;\n    const minY = topMargin;\n    const maxY = h - bottomMargin - celestialSize;\n\n    const safeDistance = moonR + 80;\n\n    const newPos: Record<string, { x: number; y: number }> = {};\n    celestialBodies.forEach(body => {\n      if (positions[body.id]) {\n        newPos[body.id] = positions[body.id];\n      } else {\n        let x: number, y: number, cnt = 0;\n        let angle: number;\n        do {\n          angle = Math.random() * Math.PI * 2;\n          const minDist = safeDistance;\n          const maxDist = Math.min(\n            Math.min(moonX - minX, maxX - moonX) * 1.2,\n            Math.min(moonY - minY, maxY - moonY) * 2.7\n          );\n          const distance = minDist + Math.random() * (maxDist - minDist);\n          x = moonX + Math.cos(angle) * distance;\n          y = moonY + Math.sin(angle) * distance;\n          x = Math.max(minX, Math.min(maxX, x));\n          y = Math.max(minY, Math.min(maxY, y));\n          cnt++;\n        } while (\n          cnt < 100 && (\n            Object.values(newPos).some(pos =>\n              Math.hypot(x - pos.x, y - pos.y) < celestialSize * 1.5\n            )\n          )\n        );\n        newPos[body.id] = { x, y };\n      }\n    });\n\n    setPositions(newPos);\n  }, [celestialBodies, moonCenter]);\n\n  const handleCelestialBodyClick = (body: CelestialBody) => {\n    if (body.isExternal && isRadioOn) {\n      setSelectedCelestialBody(body);\n    }\n  };\n\n  const handleReplySubmit = (replyText: string) => {\n    if (selectedCelestialBody && replyText.trim()) {\n      const updatedReplies = new Set([...Array.from(selectedCelestialBody.replies), replyText]);\n      const updatedCelestialBodies = celestialBodies.map(body => {\n        if (body.id === selectedCelestialBody.id) {\n          return { ...body, replies: updatedReplies };\n        }\n        return body;\n      });\n      setCelestialBodies(updatedCelestialBodies);\n      setRepliedBodies(prev => new Set([...prev, selectedCelestialBody.id]));\n      // 只有特殊星体回复后才显示文案\n      setShowResponseMessage(true);\n      setTimeout(() => {\n        setShowResponseMessage(false);\n      }, 5000);\n    }\n    setSelectedCelestialBody(null);\n  };\n\n  const handleReplyClose = () => {\n    setSelectedCelestialBody(null);\n  };\n\n  const visibleBodies = celestialBodies.filter(\n    body => !body.isExternal || (body.isExternal && isRadioOn)\n  );\n\n  return (\n    <PositionWrapper>\n      <MoonContainer>\n        <MoonSphere />\n        <FlowerOverlay>\n          {flowers.map((flower, index) => (\n            <FlowerDot\n              key={flower.id}\n              $x={flower.position.x}\n              $y={flower.position.y}\n              flowerType={flower.style === 'flower1' ? 'flower1' : flower.style === 'flower2' ? 'flower2' : 'flower3'}\n            />\n          ))}\n        </FlowerOverlay>\n      </MoonContainer>\n      {visibleBodies.map(body => {\n        const pos = positions[body.id];\n        if (!pos) return null;\n        const isReplied = repliedBodies.has(body.id);\n        \n        return (\n          <CelestialBodyContainer\n            key={body.id}\n            type={body.type}\n            x={pos.x}\n            y={pos.y}\n            isExternal={body.isExternal}\n            isReplied={isReplied && body.isExternal}\n            onClick={() => handleCelestialBodyClick(body)}\n          >\n            <Tooltip>\n              <p style={{ margin: 0 }}>{body.content}</p>\n              {body.isExternal && <p style={{ margin: '5px 0 0 0' }}>来自：{body.sender}</p>}\n            </Tooltip>\n          </CelestialBodyContainer>\n        );\n      })}\n\n      {selectedCelestialBody && (\n        <ReplyBox\n          content={selectedCelestialBody.content}\n          onSubmit={handleReplySubmit}\n          onClose={handleReplyClose}\n          replies={Array.from(selectedCelestialBody.replies)}\n        />\n      )}\n\n      {showResponseMessage && selectedCelestialBody?.isExternal && (\n        <ResponseMessage>\n          你的回应，正随着微光，穿越宇宙飞向他人💫\n        </ResponseMessage>\n      )}\n    </PositionWrapper>\n  );\n};\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}